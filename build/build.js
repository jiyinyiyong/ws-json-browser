;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
// Generated by CoffeeScript 1.6.2
var delay, ws;

delay = function(t, f) {
  return setTimeout(f, t);
};

ws = require("../lib/index");

ws.connect(3000);

ws.onopen(function() {
  return console.log("opened");
});

ws.on("greet", function(data) {
  return console.log(data);
});

ws.on("delay", function(data) {
  return console.log("delay", data);
});

console.log("start");

delay(1000, function() {
  return ws.emit("call", "from client");
});

ws.on("repeat", function(data) {
  ws.emit("repeat", data);
  return console.log("have data", data);
});

},{"../lib/index":2}],2:[function(require,module,exports){
// Generated by CoffeeScript 1.6.2
var route;

route = {};

exports.on = function(key, callback) {
  return route[key] = callback;
};

exports.connect = function(domain, port) {
  var socket;

  if (port == null) {
    port = Number(domain);
    domain = location.hostname;
  }
  socket = new WebSocket("ws://" + domain + ":" + port);
  exports.emit = function(key, value) {
    return socket.send(JSON.stringify({
      key: key,
      value: value
    }));
  };
  socket.onmessage = function(event) {
    var data, _name;

    data = JSON.parse(event.data);
    return typeof route[_name = data.key] === "function" ? route[_name](data.value) : void 0;
  };
  exports.onopen = function(callback) {
    return socket.onopen = callback;
  };
  return exports;
};

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvb3B0L3Mvd3MtanNvbi1jbGllbnQvbGliL3Rlc3QuanMiLCIvb3B0L3Mvd3MtanNvbi1jbGllbnQvbGliL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjJcbnZhciBkZWxheSwgd3M7XG5cbmRlbGF5ID0gZnVuY3Rpb24odCwgZikge1xuICByZXR1cm4gc2V0VGltZW91dChmLCB0KTtcbn07XG5cbndzID0gcmVxdWlyZShcIi4uL2xpYi9pbmRleFwiKTtcblxud3MuY29ubmVjdCgzMDAwKTtcblxud3Mub25vcGVuKGZ1bmN0aW9uKCkge1xuICByZXR1cm4gY29uc29sZS5sb2coXCJvcGVuZWRcIik7XG59KTtcblxud3Mub24oXCJncmVldFwiLCBmdW5jdGlvbihkYXRhKSB7XG4gIHJldHVybiBjb25zb2xlLmxvZyhkYXRhKTtcbn0pO1xuXG53cy5vbihcImRlbGF5XCIsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgcmV0dXJuIGNvbnNvbGUubG9nKFwiZGVsYXlcIiwgZGF0YSk7XG59KTtcblxuY29uc29sZS5sb2coXCJzdGFydFwiKTtcblxuZGVsYXkoMTAwMCwgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB3cy5lbWl0KFwiY2FsbFwiLCBcImZyb20gY2xpZW50XCIpO1xufSk7XG5cbndzLm9uKFwicmVwZWF0XCIsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgd3MuZW1pdChcInJlcGVhdFwiLCBkYXRhKTtcbiAgcmV0dXJuIGNvbnNvbGUubG9nKFwiaGF2ZSBkYXRhXCIsIGRhdGEpO1xufSk7XG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4yXG52YXIgcm91dGU7XG5cbnJvdXRlID0ge307XG5cbmV4cG9ydHMub24gPSBmdW5jdGlvbihrZXksIGNhbGxiYWNrKSB7XG4gIHJldHVybiByb3V0ZVtrZXldID0gY2FsbGJhY2s7XG59O1xuXG5leHBvcnRzLmNvbm5lY3QgPSBmdW5jdGlvbihkb21haW4sIHBvcnQpIHtcbiAgdmFyIHNvY2tldDtcblxuICBpZiAocG9ydCA9PSBudWxsKSB7XG4gICAgcG9ydCA9IE51bWJlcihkb21haW4pO1xuICAgIGRvbWFpbiA9IGxvY2F0aW9uLmhvc3RuYW1lO1xuICB9XG4gIHNvY2tldCA9IG5ldyBXZWJTb2NrZXQoXCJ3czovL1wiICsgZG9tYWluICsgXCI6XCIgKyBwb3J0KTtcbiAgZXhwb3J0cy5lbWl0ID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgIHJldHVybiBzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICBrZXk6IGtleSxcbiAgICAgIHZhbHVlOiB2YWx1ZVxuICAgIH0pKTtcbiAgfTtcbiAgc29ja2V0Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGRhdGEsIF9uYW1lO1xuXG4gICAgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XG4gICAgcmV0dXJuIHR5cGVvZiByb3V0ZVtfbmFtZSA9IGRhdGEua2V5XSA9PT0gXCJmdW5jdGlvblwiID8gcm91dGVbX25hbWVdKGRhdGEudmFsdWUpIDogdm9pZCAwO1xuICB9O1xuICBleHBvcnRzLm9ub3BlbiA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIHNvY2tldC5vbm9wZW4gPSBjYWxsYmFjaztcbiAgfTtcbiAgcmV0dXJuIGV4cG9ydHM7XG59O1xuIl19
;